<div class="container">
  <!-- Formulario para crear una nueva experiencia -->
  <div class="experiencia-form">
    <h2>Crear Nueva Experiencia</h2>
    <form (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label for="owner">Propietario:</label>
        <select id="owner" [(ngModel)]="newExperience.owner" name="owner" required>
          <option *ngFor="let user of users" [value]="user._id">
            {{ user.name }}
          </option>
        </select>
      </div>
      <div class="form-group">
        <label for="participants">Participantes:</label>
        <select id="participants" [(ngModel)]="selectedParticipants" name="participants" multiple>
          <option *ngFor="let user of users" [value]="user._id">
            {{ user.name }}
          </option>
        </select>
      </div>
      <div class="form-group">
        <label for="description">Descripción:</label>
        <textarea id="description" [(ngModel)]="newExperience.description" name="description" required maxlength="300"></textarea>
        <small class="character-limit">Máximo 300 caracteres</small>
      </div>
      <button type="submit">Enviar</button>
    </form>
    <!-- Mensaje de error debajo del formulario -->
    <div class="error-message" *ngIf="errorMessage">
      {{ errorMessage }}
    </div>
  </div>

  <div class="experiencia-form2">
    <h2>Filtrar</h2>
    <form (ngSubmit)="onFilter()">
      <div class="form-group">
        <label for="owner">Propietario:</label>
        <select id="owner" [(ngModel)]="newExperience2.owner" name="owner">
          <option *ngFor="let user of users" [value]="user._id">
            {{ user.name }}
          </option>
        </select>
      </div> 
      <button type="filter">Filtrar</button> 
    </form>
    <button (click)="elFilter()">Quitar filtros</button> 
    <!-- Mensaje de error debajo del formulario -->
    <div class="error-message" *ngIf="errorMessage">
      {{ errorMessage }}
    </div>
  </div>

  <!-- Lista de experiencias -->
  <div class="experiencia-list">
    <h1>Lista de Experiencias</h1>
    <ul>
      <li *ngFor="let experiencia of experiencias; let i = index">
        <h3>Propietario: {{ getNameByOwner(experiencia.owner) }}</h3>
        <!-- <p>Descripción: {{ experiencia.description | truncate: 60}}</p> -->
        <p>Descripción: {{ experiencia.description}}</p>
        <h4>Participantes:</h4>
        <ul>
          <li *ngFor="let participant of experiencia.participants">
            {{ getUserNameById(participant) }}
          </li>
        </ul>
        <button (click)="toggleHabilitacion(i)">
          {{ experiencia.habilitado ? 'Inhabilitar' : 'Habilitar' }}
        </button>
        <!-- Botón para eliminar la experiencia -->
        <button (click)="showModal()">Eliminar</button>
            <div class="modal" *ngIf="isModalVisible">
              <div class="modal-content">
                <h2>¿Estás seguro?</h2>
                <p>¿Realmente deseas eliminar este usuario?</p>
                <div class="modal-footer">
                  <button *ngIf="experiencia._id !== undefined" (click)="deleteExperience(experiencia._id)">Sí</button>
                  <button (click)="closeModal()">No</button>
                </div>
              </div>
            </div> 
      </li>
    </ul>
  </div>
</div>
